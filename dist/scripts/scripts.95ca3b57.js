!function(){"use strict";angular.module("mustaskeClientApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngMaterial","ngMessages","btford.socket-io","chart.js"])}(),function(){"use strict";function a(a){a.otherwise({redirectTo:"/"})}var b=angular.module("mustaskeClientApp");b.config(["$routeProvider",a])}(),function(){"use strict";function a(a,f){d=a,e=f,c(),b()}function b(){e.fontSet("fa","fontawesome")}function c(){d.definePalette("mustaskePrimary",{50:"#3f7baf",100:"#386e9c",200:"#316189",300:"#2a5377",400:"#244664",500:"#1D3951",600:"#162c3e",700:"#101f2b",800:"#ffffff",900:"#ffffff",A100:"#4988be",A200:"#5c94c5",A400:"#6fa1cb",A700:"#ffffff",contrastDefaultColor:"light",contrastDarkColors:"50 100 200 A100 A200"}),d.definePalette("mustaskeAccent",{50:"#ffffff",100:"#ffffff",200:"#ffffff",300:"#fbfbfb",400:"#efefef",500:"#E2E2E2",600:"#d5d5d5",700:"#c8c8c8",800:"#bcbcbc",900:"#afafaf",A100:"#ffffff",A200:"#ffffff",A400:"#ffffff",A700:"#a2a2a2"}),d.theme("default").primaryPalette("mustaskePrimary").accentPalette("mustaskeAccent")}angular.module("mustaskeClientApp").config(["$mdThemingProvider","$mdIconProvider",a]);var d,e}(),function(){"use strict";angular.module("mustaskeClientApp").run(["$rootScope","$location",function(a,b){a.$on("$locationChangeStart",function(a,b,c){console.log("$locationChangeStart",a,"Next",b,"current",c)})}])}(),function(){"use strict";angular.module("mustaskeClientApp").directive("loginOverlay",function(){return{templateUrl:"views/login-overlay.tpl.html",restrict:"E",scope:{},controller:"OverlayController",controllerAs:"ctrl"}})}(),function(){"use strict";function a(a,f,g){return c=a,d=f,e=g,{templateUrl:"views/question-card.tpl.html",restrict:"E",scope:{question:"="},link:b}}function b(a){a.hide=!0;var b={isUpVoted:!0};a.voteControls=b,a.detailToggle=function(){c.debug(a.hide),a.hide=!a.hide},a.upVote=function(a){a.hasVotedUp?a.hasVotedUp=!1:(a.hasVotedUp=!0,a.hasVotedDown&&(a.hasVotedDown=!1)),e.upVoteQuestion(a.question_id)},a.downVote=function(a){a.hasVotedDown?a.hasVotedDown=!1:(a.hasVotedDown=!0,a.hasVotedUp&&(a.hasVotedUp=!1)),e.downVoteQuestion(a.question_id)},a.isRoomOwner=d.isRoomOwner()}angular.module("mustaskeClientApp").directive("questionCard",["$log","UserService","SocketService",a]);var c,d,e}(),function(){"use strict";function a(a,e){return d=a,c=e,{templateUrl:"views/question-input-fab.tpl.html",restrict:"E",scope:{},link:b}}function b(a){a.openOpenBottomSheet=function(){c.show({templateUrl:"views/question-input-bottom-sheet.tpl.html",controller:"QuestionInputController",controllerAs:"ctrl",clickOutsideToClose:!1}).then(function(a){d.debug(a)})}}angular.module("mustaskeClientApp").directive("questionInputFab",["$log","$mdBottomSheet",a]);var c,d}(),function(){"use strict";function a(){return{templateUrl:"views/topbar.tpl.html",restrict:"E"}}angular.module("mustaskeClientApp").directive("topbar",[a])}(),function(){"use strict";function a(a){return c=a,{templateUrl:"views/clicker-input-button.tpl.html",restrict:"E",scope:{},link:b}}function b(a){a.openOpenBottomSheet=function(){c.show({templateUrl:"views/clicker-input-bottom-sheet.tpl.html",controller:"ClickerInputController",controllerAs:"ctrl",clickOutsideToClose:!1})}}angular.module("mustaskeClientApp").directive("clickerInput",["$mdBottomSheet",a]);var c}(),function(){"use strict";function a(){return{templateUrl:"views/top-questions.view.html",controller:"TopQuestionsController",controllerAs:"ctrl",scope:{},restrict:"E"}}angular.module("mustaskeClientApp").directive("topQuestions",[a])}(),function(){"use strict";function a(){return{templateUrl:"views/recent-questions.view.html",controller:"RecentQuestionsController",controllerAs:"ctrl",scope:{},restrict:"E"}}angular.module("mustaskeClientApp").directive("recentQuestions",[a])}(),function(){"use strict";function a(){return{templateUrl:"views/poll.view.html",controller:"PollController",controllerAs:"ctrl",scope:{},restrict:"E"}}angular.module("mustaskeClientApp").directive("poll",[a])}(),function(){"use strict";function a(){return{templateUrl:"views/settings.view.html",controller:"SettingsController",controllerAs:"ctrl",scope:{},restrict:"E"}}angular.module("mustaskeClientApp").directive("settings",[a])}(),function(){"use strict";function a(a,e){return c=a,d=e,{template:"<span>{{time}}</span>",restrict:"E",scope:{timer:"="},link:b}}function b(a){function b(){f++,60===f&&(f=0,g++);var b=f.toString(),c=g.toString();10>f&&(b="0"+b),a.time=c+":"+b}a.internalTimer=a.timer||{},a.internalTimer.start=function(){a.time="0:00",f=0,g=0,e=d(b,1e3)},a.internalTimer.stop=function(){d.cancel(e),a.time="0:00"}}angular.module("mustaskeClientApp").directive("maTimer",["$log","$interval",a]);var c,d,e,f=0,g=0}(),function(){"use strict";function a(a,b,h,i){e=a,d=h,f=b,g=i,c=this,c.events={JOIN_ROOM:"join room",CREATE_ROOM:"create room",NEW_QUESTION:"new question",UP_VOTE_QUESTION:"upvote question",DOWN_VOTE_QUESTION:"downvote question",SET_POLL_ACTIVE:"set active poll",START_POLL:"start poll",STOP_POLL:"stop poll",VOTE_POLL:"vote poll"}}function b(a){var b=f.defer();return d.on(a,function(c){e.debug("SocketService:response",a,c),c?b.resolve(c):b.reject(c)}),b.promise}angular.module("mustaskeClientApp").service("SocketService",["$log","$q","Socket","RoomService",a]);var c,d,e,f,g;a.prototype.joinRoom=function(a){return e.debug("SocketService#joinRoom:roomId:",a),d.emit(c.events.JOIN_ROOM,a),b(c.events.JOIN_ROOM)},a.prototype.createRoom=function(a){return e.debug("SocketService#createRoom:roomName:",a),d.emit(c.events.CREATE_ROOM,a),b(c.events.CREATE_ROOM)},a.prototype.newQuestion=function(a){e.debug("SocketService#newQuestion:question:",a),d.emit(c.events.NEW_QUESTION,a)},a.prototype.upVoteQuestion=function(a){var b=g.getRoomId();e.debug("SocketService#upVoteQuestion:questionId:",a,b),d.emit(c.events.UP_VOTE_QUESTION,{room_id:b,question_id:a})},a.prototype.downVoteQuestion=function(a){var b=g.getRoomId();e.debug("SocketService#upVoteQuestion:questionId:",a,b),d.emit(c.events.DOWN_VOTE_QUESTION,{room_id:b,question_id:a})},a.prototype.dismissQuestion=function(){},a.prototype.warnUser=function(){},a.prototype.activatePolling=function(){var a=g.getRoomId();e.debug("SocketService#activatePolling:",a);var b={room_id:a,active:!0};d.emit(c.events.SET_POLL_ACTIVE,b)},a.prototype.deactivatePolling=function(){var a=g.getRoomId();e.debug("SocketService#deactivatePolling:",a);var b={room_id:a,active:!1};d.emit(c.events.SET_POLL_ACTIVE,b)},a.prototype.votePoll=function(a){e.debug("SocketService#votePoll:option:",a);var b={room_id:g.getRoomId(),option:a};d.emit(c.events.VOTE_POLL,b)},a.prototype.closePoll=function(){},a.prototype.io=function(){return d},a.prototype.deleteRoom=function(a){e.debug("SocketService#deleteRoom:roomId:",a),d.emit("leave room",a)}}(),function(){"use strict";function a(a,e){b=this,c=a,d=e}angular.module("mustaskeClientApp").service("SettingsService",["SocketService","UserService",a]);var b,c,d}(),function(){"use strict";function a(a){d=a,b=this,c={answers:[]},e={},b.types={AUDIENCE:"audience",OWNER:"owner"},c.type=b.types.AUDIENCE}angular.module("mustaskeClientApp").service("UserService",["$log",a]);var b,c,d,e;a.prototype.setRoomData=function(a){angular.extend(e,a)},a.prototype.setUser=function(a){c=a},a.prototype.setUserType=function(a){c.type=a},a.prototype.setUserId=function(a){c.id=a},a.prototype.getType=function(){return c.type},a.prototype.isRoomOwner=function(){return"owner"===c.type},a.prototype.getUserId=function(){return c.id},a.prototype.getRoomName=function(){return e?e.room_name:void 0},a.prototype.getRoomId=function(){return e?e.room_id:void 0},a.prototype.getAnswers=function(){return c.answers},a.prototype.addPollAnswer=function(a){return c.answers?(c.answers.push(a),c.answers):(c.answers=[a],c.answers)}}(),function(){"use strict";function a(a){c=a,d=this,b={room_name:"",room_id:"",questions:[],top_questions:[]}}angular.module("mustaskeClientApp").service("RoomService",["$log",a]);var b,c,d;a.prototype.setRoomData=function(a){b.room_name=a.room_name,b.room_id=a.room_id,a.questions&&a.questions.length>0&&b.questions.push.apply(b.questions,a.questions),a.top_questions&&a.top_questions.length>0&&b.top_questions.push.apply(b.top_questions,a.top_questions)},a.prototype.addQuestion=function(a){b.questions.unshift(a)},a.prototype.getTopQuestions=function(){return b.questions},a.prototype.getQuestions=function(){return b.questions},a.prototype.getRoomId=function(){return b.room_id},a.prototype.getRoomName=function(){return b.room_name},a.prototype.updateVote=function(a){angular.forEach(b.questions,function(b){b.question_id===a.question_id&&(b.question_score=a.question_score)})}}(),function(){"use strict";function a(a,g){b=this,d=g,c=a,e={current:"",all:[]},f=["A","B","C","D","E"],b.isPollStarted=!1}angular.module("mustaskeClientApp").service("ClickerService",["$mdBottomSheet","SocketService",a]);var b,c,d,e,f;a.prototype.getButtons=function(){return f},a.prototype.openClicker=function(){c.show({templateUrl:"views/clicker-input-bottom-sheet.tpl.html",controller:"ClickerInputController",controllerAs:"ctrl",clickOutsideToClose:!0})},a.prototype.closeClicker=function(){c.cancel()},a.prototype.getPollStatus=function(){return b.isPollStarted},a.prototype.setPollStatus=function(a){b.isPollStarted=a},a.prototype.vote=function(a){d.votePoll(a),e.current=a},a.prototype.saveCurrentVote=function(){e.all.push(e.current)},a.prototype.getAnswers=function(){return e}}(),function(){"use strict";function a(a,c){b=a;var d=io.connect();return b.debug("check 1",d.connected),d.on("connect",function(){b.debug("check 2",d.connected)}),c({ioSocket:d})}angular.module("mustaskeClientApp").factory("Socket",["$log","socketFactory",a]);var b}(),function(){"use strict";function a(a){return c=a,b}function b(a,b){d=b,e={},angular.forEach(a,function(a){e[a]=0}),d[0]=_.values(e)}angular.module("mustaskeClientApp").factory("Votes",["$log",a]);var c,d,e,f;b.prototype.updateVotes=function(a){angular.forEach(a,function(a,b){e[b]=a});var b=_.values(e);f=_.foldl(b,function(a,b){return a+b},0),0>=f||(d[0]=_.map(b,function(a){return a/f*100}))},b.prototype.getTotalVotes=function(){return f},b.prototype.getDatumn=function(){return d}}(),function(){"use strict";function a(a,c,d,e,f,g){m=d,l=c,k=f,j=e,n=g,i=a,h=this,h.showRoom=!1,h.overlayHide=!1,h.isLeaving=!1,h.input={pattern:/^[A-Za-z]+-[A-Za-z]+-\d+$/},b()}function b(){k.io().on("leave room",function(){h.isLeaving=!0,h.roomName="",h.overlayHide=!1})}function c(a){i.debug("Failed to join room: ",a)}function d(a){j.setRoomData(a),n.setRoomData(a),i.debug(j.getType()),i.debug(j.getRoomName()),m.roomName=j.getRoomName(),m.roomId=n.getRoomId(),h.overlayHide=!0}function e(a){i.debug("Failed to join room: ",a)}function f(a){n.setRoomData(a),j.setRoomData(a),j.setUserType("owner"),i.debug(j.getType()),i.debug(j.getRoomName()),m.isRoomOwner=j.isRoomOwner(),m.roomName=n.getRoomName(),m.roomId=n.getRoomId(),h.overlayHide=!0}var g=angular.module("mustaskeClientApp");g.controller("OverlayController",["$log","$scope","$rootScope","UserService","SocketService","RoomService",a]);var h,i,j,k,l,m,n;a.prototype.joinRoom=function(){k.joinRoom(h.roomName).then(d,c)},a.prototype.createRoom=function(){k.createRoom(h.roomName).then(f,e)},a.prototype.toggleAlias=function(){h.showRoom=!h.showRoom}}(),function(){"use strict";function a(a,c,i,j){e=a,f=c,g=i,h=j,d=this,d.selectedIndex=0,d.isFabOpen=!1,b()}function b(){f.io().on(f.events.NEW_QUESTION,function(a){g.addQuestion(a)}),f.io().on(f.events.UP_VOTE_QUESTION,function(a){g.updateVote(a)}),f.io().on(f.events.DOWN_VOTE_QUESTION,function(a){g.updateVote(a)})}var c=angular.module("mustaskeClientApp");c.controller("AppController",["$log","SocketService","RoomService","UserService",a]);var d,e,f,g,h}(),function(){"use strict";function a(a,c,d,e,n,o,p){g=c,h=d,i=e,j=n,l=o,k=a,f=this,f.timer={},f.answers=i.getAnswers(),f.buttons=i.getButtons(),f.chart={labels:f.buttons,data:[[30,50,5,10,5]],options:{scaleShowGridLines:!1,scaleShowHorizontalLines:!1,scaleShowVerticalLines:!1,responsive:!0,maintainAspectRatio:!1,barShowStroke:!1,barValueSpacing:15,scaleShowLabels:!1,tooltipTemplate:'<%= value + " %" %>'},colours:[{fillColor:"#1D3951"}]},m=new p(f.chart.labels,f.chart.data),b()}function b(){f.poll={counter:0,isPollStarted:!1},f.isRoomOwner=!1,h.$watch(function(){return i.getPollStatus()},function(a){f.poll.isPollStarted=a}),h.$watch(function(){return j.isRoomOwner()},function(a){f.isRoomOwner=a}),l.io().on(l.events.START_POLL,d),l.io().on(l.events.STOP_POLL,c)}function c(){return k.debug("Pull stopped"),f.poll.isPollStarted=!1,j.isRoomOwner()?void f.timer.stop():(i.closeClicker(),void i.saveCurrentVote())}function d(a){return k.debug("Pull started",a),f.poll.isPollStarted=!0,j.isRoomOwner()?(f.timer.start(),void l.io().on(l.events.VOTE_POLL,e)):void i.openClicker()}function e(a){k.debug("Poll vote",a),m.updateVotes(a)}angular.module("mustaskeClientApp").controller("PollController",["$log","$interval","$scope","ClickerService","UserService","SocketService","Votes",a]);var f,g,h,i,j,k,l,m;a.prototype.startPoll=function(){l.activatePolling()},a.prototype.stopPoll=function(){l.deactivatePolling(),m.updateVotes({A:0,B:0,C:0,D:0,E:0})},a.prototype.restartVote=function(){f.poll.isPollStarted&&i.openClicker()}}(),function(){"use strict";function a(a,e){d=a,b=this,b.topIndex=0,c=e,b.questions=c.getQuestions(),d.debug("Questions: ",b.questions)}angular.module("mustaskeClientApp").controller("RecentQuestionsController",["$log","RoomService",a]);var b,c,d}(),function(){"use strict";function a(a,f,g){e=a,d=g,c=f,b=this,b.topIndex=0,b.topQuestions=d.getTopQuestions(),e.debug("Top Questions: ",b.topQuestions)}angular.module("mustaskeClientApp").controller("TopQuestionsController",["$log","SocketService","RoomService",a]);var b,c,d,e;a.prototype.zeroOrNull=function(a){return void 0!==a.question_score&&a.question_score>0}}(),function(){"use strict";function a(a,g,h,i){b=this,e=a,f=i,c=h,d=g,b.newQuestion=""}angular.module("mustaskeClientApp").controller("QuestionInputController",["$log","$mdBottomSheet","SocketService","RoomService",a]);var b,c,d,e,f;a.prototype.submitQuestion=function(a){var e={room_id:f.getRoomId(),question_text:b.newQuestion};c.newQuestion(e),d.hide(b.newQuestion),a&&a.preventDefault()}}(),function(){"use strict";function a(a,i,j,k,l){g=a,d=j,e=k,f=l,h=i,c=this,b()}function b(){h.$watch(function(){return d.getRoomId()},function(a){c.roomId=a}),h.$watch(function(){return e.isRoomOwner()},function(a){c.message=a?"Delete Room":"Leave Room"})}angular.module("mustaskeClientApp").controller("SettingsController",["$log","$scope","RoomService","UserService","SocketService",a]);var c,d,e,f,g,h;a.prototype.removeRoom=function(){f.deleteRoom(c.roomId)}}(),function(){"use strict";function a(a,f,g){c=g,d=f,e=a,b=this,b.answers=d.getAnswers(),b.buttons=d.getButtons()}angular.module("mustaskeClientApp").controller("ClickerInputController",["$log","ClickerService","SocketService",a]);var b,c,d,e;a.prototype.submitAnswer=function(a){d.vote(a)}}();